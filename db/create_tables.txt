mysql -u root -p
[write password]

[CREATE DATABASE posrello;]
[USE posrello;]


CREATE TABLE Users (
userid INT NOT NULL AUTO_INCREMENT,
name VARCHAR(50),
PRIMARY KEY(userid)
);

CREATE TABLE Projects (
pid INT NOT NULL AUTO_INCREMENT,
name VARCHAR(50),
PRIMARY KEY(pid)
);

CREATE TABLE Involves (
uid INT NOT NULL,
pid INT NOT NULL,
FOREIGN KEY(uid) REFERENCES Users(userid)
	ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY(pid) REFERENCES Projects(pid)
	ON UPDATE CASCADE ON DELETE CASCADE,
PRIMARY KEY(uid, pid)
);

CREATE TABLE Invites (
uid INT NOT NULL,
pid INT NOT NULL,
FOREIGN KEY(uid) REFERENCES Users(userid)
	ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY(pid) REFERENCES Projects(pid)
	ON UPDATE CASCADE ON DELETE CASCADE,
PRIMARY KEY(uid, pid)
);

CREATE TABLE Substeps (
sid INT NOT NULL AUTO_INCREMENT,
pid INT NOT NULL,
name VARCHAR(50),
FOREIGN KEY(pid) REFERENCES Projects(pid)
	ON UPDATE CASCADE ON DELETE CASCADE,
PRIMARY KEY(sid)
);

CREATE TABLE Involve_Substeps (
uid INT NOT NULL,
sid INT NOT NULL,
FOREIGN KEY(uid) REFERENCES Users(userid)
	ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY(sid) REFERENCES Substeps(sid)
	ON UPDATE CASCADE ON DELETE CASCADE,
PRIMARY KEY(uid, sid)
);

CREATE TABLE Details (
sid INT NOT NULL,
name VARCHAR(50),
finished INT NOT NULL DEFAULT 0,
FOREIGN KEY(sid) REFERENCES Substeps(sid)
	ON UPDATE CASCADE ON DELETE CASCADE,
PRIMARY KEY(sid, name)
);

CREATE TABLE Comments (
sid INT NOT NULL,
contents VARCHAR(200),
FOREIGN KEY(sid) REFERENCES Substeps(sid)
	ON UPDATE CASCADE ON DELETE CASCADE
);


DROP TABLE Comments;
DROP TABLE Details;
DROP TABLE Involve_Substeps;
DROP TABLE Substeps;
DROP TABLE Invites;
DROP TABLE Involves;
DROP TABLE Projects;
DROP TABLE Users;
